<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DEBUG - BRAVORIAN</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
</head>
<body class="bg-slate-900 text-white p-6">

    <div id="debug-box" class="fixed bottom-0 left-0 right-0 bg-black/80 p-4 h-64 overflow-y-auto border-t border-yellow-400 font-mono text-[10px]">
        <p class="text-yellow-400 font-bold underline mb-2 uppercase">Laporan Sistem (Debug Log):</p>
        <div id="logs"></div>
    </div>

    <div id="ui-container" class="text-center mt-20">
        <div id="spinner" class="w-10 h-10 border-4 border-yellow-400 border-t-transparent rounded-full animate-spin mx-auto"></div>
        <p id="status-text" class="mt-4 text-sm font-bold uppercase tracking-widest">Memulakan Sistem...</p>
    </div>

    <script>
        const logEl = document.getElementById('logs');
        function addLog(msg, color = "text-white") {
            const p = document.createElement('p');
            p.className = color;
            p.innerText = `[${new Date().toLocaleTimeString()}] ${msg}`;
            logEl.appendChild(p);
            logEl.scrollTop = logEl.scrollHeight;
        }

        window.onerror = function(m, u, l) { addLog(`CRASH: ${m} at line ${l}`, "text-red-500"); };

        try {
            addLog("Langkah 1: Memuatkan konfigurasi...");
            const firebaseConfig = { 
                apiKey: "AIzaSyCQ9SBXkEILe6PZdmLyGBSFK63XhPM_V7o", 
                authDomain: "bravorians-bsi.firebaseapp.com", 
                databaseURL: "https://bravorians-bsi-default-rtdb.asia-southeast1.firebasedatabase.app", 
                projectId: "bravorians-bsi", 
                appId: "1:314220494464:web:d3b21e9b742e1db86f7065" 
            };

            addLog("Langkah 2: Menghubung ke Firebase...");
            firebase.initializeApp(firebaseConfig);
            addLog("Berjaya: Firebase App Initialized.", "text-green-400");

            const auth = firebase.auth();
            const db = firebase.database();

            addLog("Langkah 3: Memeriksa sambungan Database...");
            // Ujian sambungan database secara terus
            const connectedRef = db.ref(".info/connected");
            connectedRef.on("value", (snap) => {
                if (snap.val() === true) {
                    addLog("Status: DATABASE TERHUBUNG!", "text-green-400");
                } else {
                    addLog("Status: DATABASE TERPUTUS (Menunggu...)", "text-orange-400");
                }
            });

            addLog("Langkah 4: Memeriksa status login...");
            auth.onAuthStateChanged(user => {
                addLog("Status: Auth State Changed.");
                document.getElementById('spinner').style.display = 'none';
                if (user) {
                    addLog(`User dikesan: ${user.email}`, "text-green-400");
                    document.getElementById('status-text').innerText = "ANDA TELAH LOGIN";
                } else {
                    addLog("Status: Tiada user login.", "text-yellow-400");
                    document.getElementById('status-text').innerText = "SEDIA UNTUK LOGIN";
                }
            });

        } catch (e) {
            addLog(`RALAT KRITIKAL: ${e.message}`, "text-red-500");
        }
    </script>
</body>
</html>
